---
import Layout from '@layouts/Layout.astro';
import Container from '@components/Container.astro';
import BackToPrevious from '@components/BackToPrevious.astro';
import Trakt from '@components/Trakt.astro';
import traktData from '../data/trakt.json';

const title = 'Movies & TV';
const description = 'A curated collection of film and television ratings.';

const { allRatings } = traktData;

const schema = {
  '@context': 'https://schema.org',
  '@graph': (allRatings || []).map((item: any) => ({
    '@type': 'Review',
    itemReviewed: {
      '@type': item.type === 'show' ? 'TVSeries' : 'Movie',
      name: item.title,
      image: item.poster,
    },
    reviewRating: {
      '@type': 'Rating',
      ratingValue: item.rating,
      bestRating: '10',
      worstRating: '1',
    },
    author: {
      '@type': 'Person',
      name: 'Eddie Welker',
    },
  })),
};
---

<Layout title={title} description={description}>
  <script type="application/ld+json" set:html={JSON.stringify(schema)} />
  <Container>
    <div class="animate">
      <BackToPrevious href="/" />
      <div class="block h-24 w-full md:h-32"></div>

      <header class="mb-12">
        <h1
          class="text-3xl leading-none font-black tracking-tighter text-black uppercase dark:text-white"
        >
          Movies & TV
        </h1>
        <p class="mt-2 max-w-lg text-sm leading-relaxed text-neutral-500">
          My reviewed watches curated via Trakt.
        </p>
      </header>

      <Trakt />

      <footer class="mt-20 border-t border-black/10 pt-24 pb-12 dark:border-white/10"></footer>
    </div>
  </Container>
</Layout>
