---
import Layout from "@layouts/Layout.astro";
import Container from "@components/Container.astro";
import { getCollection } from "astro:content";
import { SITE } from "@consts";

// Fetch from the new 'highlights' collection
const highlights = (await getCollection("highlights"))
  .filter((item) => !item.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

<Layout title={`Highlights | ${SITE.TITLE}`} description="Curated photos and code.">
  <Container>
    <div class="space-y-4">
      <h1 class="font-semibold text-black dark:text-white text-xl mb-6">
        Highlights
      </h1>

      <div class="grid grid-cols-1 gap-4">
        {highlights.map((item) => (
          <div class="border border-black/15 dark:border-white/20 p-4 rounded-sm hover:bg-black/5 dark:hover:bg-white/5 transition-colors">
            <h3 class="font-semibold text-black dark:text-white">
              {/* If 'url' exists, link externally. Otherwise, link internally. */}
              <a
                href={item.data.url || `/highlights/${item.id}/`}
                target={item.data.url ? "_blank" : "_self"}
                rel={item.data.url ? "noopener noreferrer" : ""}
                class="hover:underline"
              >
                {item.data.title}
                {item.data.url && <span class="text-xs ml-1 opacity-70">â†—</span>}
              </a>
            </h3>
            <p class="text-sm text-black/60 dark:text-white/60 mt-1">
              {item.data.description}
            </p>
          </div>
        ))}
      </div>

    </div>
  </Container>
</Layout>
