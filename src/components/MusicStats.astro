---
import musicData from '../data/music.json';

// Use default empty objects
const {
  user = { scrobbles: 0 },
  artists = { weekly: [], monthly: [] },
  albums = { weekly: [], monthly: [] }
} = musicData || {};
---

<div class="space-y-6">

  {/* Header */}
  <div class="flex justify-between items-end pb-4 border-b border-black/10 dark:border-white/10">
    <div class="flex items-center gap-2">
      <h3 class="font-semibold text-black dark:text-white">Recent Music</h3>
    </div>
    <div class="text-xs font-mono text-neutral-500">
      {user.scrobbles.toLocaleString()} lifetime scrobbles
    </div>
  </div>

  <div class="grid md:grid-cols-2 gap-8 md:gap-8 md:divide-x divide-black/10 dark:divide-white/10">

    {/* COLUMN 1: WEEKLY */}
    <div class="space-y-6 md:pr-4">
      <h4 class="text-xs uppercase tracking-widest text-neutral-500 font-semibold">Last 7 Days</h4>

      {/* Weekly Albums */}
      <div class="space-y-3">
        <h5 class="text-xs font-medium text-black dark:text-white">Top Albums</h5>
        <ul class="space-y-2">
          {albums.weekly.slice(0, 3).map((alb, i) => (
            <li class="flex items-center gap-3 group">
              <span class="text-xs font-mono text-neutral-400 w-3">{i + 1}</span>
              {alb.image ? (
                <img src={alb.image} alt={alb.name} class="w-8 h-8 rounded border border-black/10 dark:border-white/10 object-cover" />
              ) : (
                <div class="w-8 h-8 rounded border border-black/10 dark:border-white/10 bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center text-[10px] text-neutral-500">CD</div>
              )}
              <div class="flex-1 min-w-0 overflow-hidden">
                <a href={alb.url} target="_blank" class="block text-sm truncate text-neutral-700 dark:text-neutral-300 group-hover:text-black dark:group-hover:text-white group-hover:underline decoration-1 underline-offset-2 transition-colors">
                  {alb.name}
                </a>
                <div class="text-xs text-neutral-500 truncate">{alb.artist}</div>
              </div>
              <span class="text-xs font-mono text-neutral-400">{alb.plays}</span>
            </li>
          ))}
        </ul>
      </div>

      {/* Weekly Artists */}
      <div class="space-y-3">
        <h5 class="text-xs font-medium text-black dark:text-white">Top Artists</h5>
        <ul class="space-y-1">
          {artists.weekly.slice(0, 5).map((art, i) => (
            <li class="flex items-baseline gap-3 group">
              <span class="text-xs font-mono text-neutral-400 w-3">{i + 1}</span>
              <div class="flex-1 min-w-0 overflow-hidden">
                <a href={art.url} target="_blank" class="block text-sm truncate text-neutral-700 dark:text-neutral-300 group-hover:text-black dark:group-hover:text-white group-hover:underline decoration-1 underline-offset-2 transition-colors">
                  {art.name}
                </a>
              </div>
              <span class="text-xs font-mono text-neutral-400">{art.plays}</span>
            </li>
          ))}
        </ul>
      </div>
    </div>

    {/* COLUMN 2: MONTHLY */}
    <div class="space-y-6 md:pl-4">
      <h4 class="text-xs uppercase tracking-widest text-neutral-500 font-semibold">Last 30 Days</h4>

      {/* Monthly Albums */}
      <div class="space-y-3">
        <h5 class="text-xs font-medium text-black dark:text-white">Top Albums</h5>
        <ul class="space-y-2">
          {albums.monthly.slice(0, 3).map((alb, i) => (
            <li class="flex items-center gap-3 group">
              <span class="text-xs font-mono text-neutral-400 w-3">{i + 1}</span>
              {alb.image ? (
                <img src={alb.image} alt={alb.name} class="w-8 h-8 rounded border border-black/10 dark:border-white/10 object-cover" />
              ) : (
                <div class="w-8 h-8 rounded border border-black/10 dark:border-white/10 bg-neutral-100 dark:bg-neutral-800 flex items-center justify-center text-[10px] text-neutral-500">CD</div>
              )}
              <div class="flex-1 min-w-0 overflow-hidden">
                <a href={alb.url} target="_blank" class="block text-sm truncate text-neutral-700 dark:text-neutral-300 group-hover:text-black dark:group-hover:text-white group-hover:underline decoration-1 underline-offset-2 transition-colors">
                  {alb.name}
                </a>
                <div class="text-xs text-neutral-500 truncate">{alb.artist}</div>
              </div>
              <span class="text-xs font-mono text-neutral-400">{alb.plays}</span>
            </li>
          ))}
        </ul>
      </div>

      {/* Monthly Artists */}
      <div class="space-y-3">
        <h5 class="text-xs font-medium text-black dark:text-white">Top Artists</h5>
        <ul class="space-y-1">
          {artists.monthly.slice(0, 5).map((art, i) => (
            <li class="flex items-baseline gap-3 group">
              <span class="text-xs font-mono text-neutral-400 w-3">{i + 1}</span>
              <div class="flex-1 min-w-0 overflow-hidden">
                <a href={art.url} target="_blank" class="block text-sm truncate text-neutral-700 dark:text-neutral-300 group-hover:text-black dark:group-hover:text-white group-hover:underline decoration-1 underline-offset-2 transition-colors">
                  {art.name}
                </a>
              </div>
              <span class="text-xs font-mono text-neutral-400">{art.plays}</span>
            </li>
          ))}
        </ul>
      </div>
    </div>

  </div>

  <div class="text-right border-t border-black/10 dark:border-white/10 pt-4">
    <a href={`https://last.fm/user/${import.meta.env.LASTFM_USERNAME}`} target="_blank" class="text-[10px] text-neutral-500 hover:text-black dark:hover:text-white uppercase tracking-wider transition-colors">
      View Profile â†—
    </a>
  </div>
</div>
